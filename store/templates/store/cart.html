{% extends 'store/main.html' %}
{% load static %}
{% load custom_filters %}
{% block content %}

<div class="row">
	<div class="col-lg-12">
		<div class="box-element">
			
			<a  class="btn btn-outline-dark" href="{% url 'store' %}">&#x2190; Continue Shopping</a>

			<br>
			<br>
			<table class="table">
				<tr>
					<th><h5>Items: <strong>{{order.get_cart_items}}</strong></h5></th>
					<th>
					</th>
				</tr>
			</table>
			<div style="flex:2"></div>
					<div style="flex:2"><strong>Items In cart</strong></div>
					<div style="flex:1"></div>
					{% for item in items %}
					<div class="cart-row">
						<div style="flex:2"><img class="row-image" src="{{ MEDIA_URL }}{{ item.product.imageURL }}"></div>
					</div>
					{% endfor %}

		</div>
        <div class="box-element">
            <div class="cart-row">
                <div style="flex:2"></div>
                <div style="flex:2"><strong>Item</strong></div>
                <div style="flex:1"><strong>Quantity</strong></div>
            </div>
            {% for master_category, items in items_by_master_category.items %}
            <h3>{{ master_category }}</h3>
            {% for item in items %}
                {% with item_id=item.id|stringformat:"s" %}
            <div class="cart-row">
				<div style="flex:2"><img class="row-image" src="{{ item.product.imageURL }}"></div>
					<div style="flex:2"><p>{{item.product.productDisplayName}}</p></div>
					
					<div style="flex:1">
						<p class="quantity">{{item.quantity}}</p>
						<div class="quantity">
							<img data-product="{{item.product.id}}" data-action="add" class="chg-quantity update-cart" src="{% static  'icons/arrow-up.png' %}">
					
							<img data-product="{{item.product.id}}" data-action="remove" class="chg-quantity update-cart" src="{% static  'icons/arrow-down.png' %}">
						</div>
					</div>
				</div>
				{% if item_id in recommended_images %}
				<div class="cart-row">
					<div style="flex:2"></div>
					<div style="flex:2"><strong>Recommended Items</strong></div>
					<div style="flex:1"></div>
				</div>
				<div class="cart-row recommended-images">
					{% for rec_image in recommended_images|get_item:item_id %}
					<div style="flex:1">
						<img class="row-image" src="{{ rec_image.image_url }}" alt="">
						<p><strong>{{ rec_image.product.productDisplayName }}</strong></p>
						<button data-product="{{ rec_image.image_url }}" data-action="add" class="btn btn-outline-secondary add-btn update-cart">Add to Cart</button>
					</div>
				{% endfor %}	
				</div>
			{% endif %}
        {% endwith %}
    {% endfor %}
	<div style="flex:2"></div>
        <div style="flex:2"><strong>Mean {{ master_category }} Recommendations</strong></div>
        <div style="flex:1"></div>
        {% if master_category in master_category_mean_recommendations %}
        <div class="cart-row">
            {% for image_path in master_category_mean_recommendations|get_item:master_category %}
            <div style="flex:2"><img class="row-image" src="{{ image_path }}"></div>
            {% endfor %}
        </div>
        {% endif %}
    {% endfor %}
        </div>
    </div>
</div>
{% endblock content %}